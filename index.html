 <!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Caption Creator — Fast, Faceless Tool</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-3xl mx-auto p-6">
    <header class="mb-6">
      <h1 class="text-3xl font-semibold">AI Caption Creator</h1>
      <p class="text-sm text-gray-600">Generate Instagram/TikTok/Facebook captions fast. No sign-ins. Anonymous.</p>
    </header><main class="bg-white rounded-xl shadow p-6">
  <label class="block mb-2 text-sm font-medium">Topic / Photo Description</label>
  <textarea id="prompt" rows="3" class="w-full p-3 border rounded" placeholder="e.g. beach sunrise with coffee, cozy cafe vibe, minimal outfit"></textarea>

  <div class="mt-4 grid grid-cols-2 gap-3">
    <select id="platform" class="p-2 border rounded">
      <option value="instagram">Instagram</option>
      <option value="tiktok">TikTok</option>
      <option value="facebook">Facebook</option>
      <option value="linkedin">LinkedIn</option>
    </select>

    <select id="tone" class="p-2 border rounded">
      <option value="funny">Funny</option>
      <option value="inspirational">Inspirational</option>
      <option value="short">Short & punchy</option>
      <option value="long">Long & descriptive</option>
      <option value="professional">Professional</option>
    </select>
  </div>

  <div class="mt-4 flex gap-3">
    <button id="generate" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Generate</button>
    <button id="copyAll" class="px-4 py-2 border rounded">Copy All</button>
    <button id="download" class="px-4 py-2 border rounded">Download TXT</button>
  </div>

  <div id="spinner" class="mt-4 hidden">Generating…</div>

  <div id="results" class="mt-4 space-y-3"></div>

  <hr class="my-5" />
  <div class="text-xs text-gray-500">
    <button>BuyMeACoffee</button>
  </div>
</main>

<footer class="mt-6 text-sm text-gray-500">Built with ❤️ — keep it legal. Do not generate copyrighted material without permission.</footer>

  </div><script>
const generateBtn = document.getElementById('generate');
const promptEl = document.getElementById('prompt');
const platformEl = document.getElementById('platform');
const toneEl = document.getElementById('tone');
const resultsEl = document.getElementById('results');
const spinner = document.getElementById('spinner');
const copyAll = document.getElementById('copyAll');
const downloadBtn = document.getElementById('download');

function makePrompt(userText, platform, tone) {
  return `You are an assistant that writes short social media captions. Platform: ${platform}. Tone: ${tone}. Create 8 distinct captions for this description: "${userText}". Each caption should be unique, ready-to-post, include up to 2 emojis, and be between 10 and 60 words. For Instagram include 3-8 relevant hashtags at the end for discoverability.`;
}

async function callGenerate(promptText) {
  spinner.classList.remove('hidden');
  generateBtn.disabled = true;
  resultsEl.innerHTML = '';
  try {
    const res = await fetch('/api/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt: promptText })
    });
    if (!res.ok) throw new Error('Server error: ' + res.status);
    const data = await res.json();
    return data.text;
  } catch (err) {
    console.error(err);
    return 'Error: ' + err.message;
  } finally {
    spinner.classList.add('hidden');
    generateBtn.disabled = false;
  }
}

function renderCaptions(text) {
  // Assume the model returns captions separated by newlines.
  const lines = text.split(/\n+/).filter(Boolean);
  resultsEl.innerHTML = '';
  lines.forEach((line, i) => {
    const wrap = document.createElement('div');
    wrap.className = 'p-3 border rounded flex justify-between items-start gap-3';
    const p = document.createElement('div');
    p.className = 'text-sm';
    p.textContent = line.trim();
    const btn = document.createElement('button');
    btn.className = 'px-2 py-1 text-xs border rounded';
    btn.textContent = 'Copy';
    btn.onclick = () => navigator.clipboard.writeText(line.trim());
    wrap.appendChild(p);
    wrap.appendChild(btn);
    resultsEl.appendChild(wrap);
  });
}

generateBtn.addEventListener('click', async () => {
  const userText = promptEl.value.trim();
  if (!userText) return alert('Write a description or topic first.');
  const platform = platformEl.value;
  const tone = toneEl.value;
  const finalPrompt = makePrompt(userText, platform, tone);
  const modelText = await callGenerate(finalPrompt);
  if (modelText.startsWith('Error:')) {
    resultsEl.innerHTML = `<div class="text-red-500">${modelText}</div>`;
  } else {
    renderCaptions(modelText);
  }
});

copyAll.addEventListener('click', async () => {
  const allText = Array.from(resultsEl.querySelectorAll('div > div:first-child')).map(d => d.textContent).join('\n\n');
  if (!allText) return alert('No captions to copy.');
  await navigator.clipboard.writeText(allText);
  alert('Copied all captions');
});

downloadBtn.addEventListener('click', () => {
  const allText = Array.from(resultsEl.querySelectorAll('div > div:first-child')).map(d => d.textContent).join('\n\n');
  if (!allText) return alert('No captions to download.');
  const blob = new Blob([allText], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'captions.txt';
  document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
});
</script></body>
</html>
